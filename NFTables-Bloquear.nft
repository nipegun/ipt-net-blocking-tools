#!/usr/bin/nft -f
flush ruleset

# CHINA
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv4/CN.ipv4"
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv6/CN.ipv6"
# RUSIA
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv4/RU.ipv4"
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv6/RU.ipv6"
# UCRANIA
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv4/UA.ipv4"
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv6/UA.ipv6"
# VIETNAM
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv4/VN.ipv4"
include "/root/scripts/non-spanish-country-blocker/geoipsets/nftset/ipv6/VN.ipv6"

table netdev filter {

	set country-ipv4-blacklist {
		type ipv4_addr
		flags interval
		elements = { $CN.ipv4, $RU.ipv4, $UA.ipv4, $VN.ipv4 }
	}

	set country-ipv6-blacklist {
		type ipv6_addr
		flags interval
		elements = { $CN.ipv6, $RU.ipv6, $UA.ipv6, $VN.ipv6 }
	}

	chain ingress {
		type filter hook ingress device <device> priority 0; policy accept;
		ip saddr @country-ipv4-blacklist counter drop
		ip6 saddr @country-ipv6-blacklist counter drop
	}

}
